<% starred = @current_user_stories.include?(story) %>
<% user_emails = display_starred_by_emails_of_other_users(story.starrables) %>

<div>
  <p>Index: <%= story_counter + 1 %></p>
  <p>id: <%= story.story_id %></p>
  <p>Title: <%= story.title %></p>
  <p>By: <%= story.author %></p>
  <p>Score: <%= story.score %></p>
  <p>Link: <%= story.url %></p>
  <p>Date: <%= story.time %></p>
  <% if user_emails.present? %>
    <p>Starred by: 
      <%= user_emails %>
    </p>
  <% end %>
  <div id=<%= "#{story.id}" %> style="display: flex" class="star-group">
    <div class="filled-star" style="width: 1%; display: <%= starred ? "flex" : "none" %>">
      <%= embedded_svg('star-filled.svg') %>
    </div>
    <div class="empty-star" style="width: 1%; display: <%= starred ? "none" : "flex" %>">
      <%= embedded_svg('star.svg') %>
    </div>
  </div>
</div>

<script>
  function toggleVisibility(group, event) {
    if (group.children[0].style.display === "none") {
      group.children[0].style.display = "flex";
      group.children[1].style.display = "none";
    } else {
      group.children[0].style.display = "none";
      group.children[1].style.display = "flex";
    }
  }

  const starGroups = document.getElementsByClassName("star-group")

  for (var i = 0; i < starGroups.length; i++) {
    const starGroup = starGroups[i];

    starGroup.addEventListener('click', (event) => {
      toggleVisibility(starGroup, event);
    });
  }
</script>
